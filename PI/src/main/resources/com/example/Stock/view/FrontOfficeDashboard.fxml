<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<?import javafx.scene.text.Text?>
<VBox xmlns="http://javafx.com/javafx/11.0.1"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.example.Stock.Controller.DashboardController"
      stylesheets="@FrontOfficeDashboard.css"
      spacing="25"
      style="-fx-background-color: #f8fafc; -fx-padding: 25;">

    <!-- Header avec titre et outils -->
    <HBox styleClass="header-container" spacing="20">
        <VBox alignment="CENTER_LEFT" spacing="5">
            <Label text="ðŸ“Š Tableau de Bord Stock" styleClass="dashboard-title"/>
            <Label text="ðŸ” Vue d'ensemble des stocks et entrepÃ´ts" styleClass="dashboard-subtitle"/>
        </VBox>

        <HBox spacing="15" alignment="CENTER_RIGHT" HBox.hgrow="ALWAYS">
            <!-- Filtres avancÃ©s -->
            <ComboBox fx:id="filterCombo" promptText="ðŸ”Ž Filtrer par..." styleClass="combo-filter"/>

            <!-- Actualiser -->
            <Button text="ðŸ”„" styleClass="refresh-btn" onAction="#handleRefresh"/>
        </HBox>
    </HBox>

    <!-- Filtres temporels -->
    <HBox fx:id="timeFilterBox" spacing="10" styleClass="filter-container" alignment="CENTER">
        <!-- Les RadioButton seulement dans le HBox -->
        <RadioButton text="ðŸ“… 7 jours" styleClass="time-filter-btn" selected="true">
            <toggleGroup>
                <ToggleGroup fx:id="timeFilterGroup"/>
            </toggleGroup>
        </RadioButton>
        <RadioButton text="ðŸ—“ï¸ 30 jours" toggleGroup="$timeFilterGroup" styleClass="time-filter-btn"/>
        <RadioButton text="ðŸ“† 90 jours" toggleGroup="$timeFilterGroup" styleClass="time-filter-btn"/>
        <RadioButton text="â±ï¸ PersonnalisÃ©" toggleGroup="$timeFilterGroup" styleClass="time-filter-btn"/>
    </HBox>

    <!-- Cartes KPI -->
    <HBox spacing="20" styleClass="kpi-container">
        <!-- Carte Stock Total -->
        <VBox styleClass="kpi-card stock-card">
            <HBox alignment="CENTER_LEFT" spacing="10">
                <Text text="ðŸ“¦" style="-fx-font-size: 24px;"/>
            </HBox>
            <Label text="Stocks Totaux" styleClass="kpi-title"/>
            <Label fx:id="totalStocksLabel" styleClass="kpi-value"/>
            <HBox spacing="5" alignment="CENTER_LEFT">
                <Label fx:id="stockTrendLabel" styleClass="kpi-trend"/>
                <Label text="vs pÃ©riode prÃ©cÃ©dente" styleClass="kpi-subtext"/>
            </HBox>
            <Separator styleClass="kpi-separator"/>
            <Label text="â±ï¸ Mis Ã  jour: aujourd'hui" styleClass="kpi-update"/>
        </VBox>

        <!-- Carte EntrepÃ´ts Actifs -->
        <VBox styleClass="kpi-card warehouse-card">
            <HBox alignment="CENTER_LEFT" spacing="10">
                <Text text="ðŸ­" style="-fx-font-size: 24px;"/>
            </HBox>
            <Label text="EntrepÃ´ts Actifs" styleClass="kpi-title"/>
            <Label fx:id="activeWarehousesLabel" styleClass="kpi-value"/>
            <Label text="ðŸ“Š CapacitÃ© moyenne: 85%" styleClass="kpi-subtext"/>
            <Separator styleClass="kpi-separator"/>
            <Label text="ðŸ—ºï¸ Voir la carte" styleClass="kpi-link" />
        </VBox>

        <!-- Carte Alertes -->
        <VBox styleClass="kpi-card alert-card">
            <HBox alignment="CENTER_LEFT" spacing="10">
                <Text text="âš ï¸" style="-fx-font-size: 24px;"/>
            </HBox>
            <Label text="Alertes Stock" styleClass="kpi-title"/>
            <Label fx:id="alertsCountLabel" styleClass="kpi-value"/>
            <Label text="â° DerniÃ¨re alerte: Produit X" styleClass="kpi-subtext"/>
            <Separator styleClass="kpi-separator"/>
            <Label text="ðŸ” Voir dÃ©tails" styleClass="kpi-link" onMouseClicked="#showAlerts"/>
        </VBox>
    </HBox>

    <!-- Graphiques -->
    <GridPane styleClass="chart-grid" hgap="20" vgap="20">
        <columnConstraints>
            <ColumnConstraints percentWidth="50"/>
            <ColumnConstraints percentWidth="50"/>
        </columnConstraints>

        <!-- Graphique Camembert -->
        <VBox styleClass="chart-card" GridPane.columnIndex="0">
            <HBox alignment="CENTER_LEFT" spacing="10">
                <Text text="ðŸ“Š" style="-fx-font-size: 20px;"/>
                <Label text="RÃ©partition par CatÃ©gorie" styleClass="chart-title"/>

            </HBox>
            <PieChart fx:id="stockPieChart" styleClass="chart" legendVisible="false"/>
            <HBox styleClass="chart-legend" spacing="10">
                <HBox styleClass="legend-item">
                    <Text text="ðŸ”µ" style="-fx-font-size: 16px;"/>
                    <Label text="Ã‰lectronique" styleClass="legend-text"/>
                </HBox>
                <HBox styleClass="legend-item">
                    <Text text="ðŸŸ " style="-fx-font-size: 16px;"/>
                    <Label text="Alimentaire" styleClass="legend-text"/>
                </HBox>
            </HBox>
        </VBox>

        <!-- Graphique Barres -->
        <VBox styleClass="chart-card" GridPane.columnIndex="1">
            <HBox alignment="CENTER_LEFT" spacing="10">
                <Text text="ðŸ“ˆ" style="-fx-font-size: 20px;"/>
                <Label text="Mouvement des Stocks (30j)" styleClass="chart-title"/>
                <Button text="ðŸ•°ï¸ Historique" styleClass="chart-detail-btn" onAction="#showStockHistory"/>
            </HBox>
            <BarChart fx:id="stockMovementChart" styleClass="chart">
                <xAxis>
                    <CategoryAxis label="Date" styleClass="axis-label"/>
                </xAxis>
                <yAxis>
                    <NumberAxis label="QuantitÃ©" styleClass="axis-label"/>
                </yAxis>
            </BarChart>
            <HBox styleClass="chart-controls" spacing="15" alignment="CENTER">
                <Button text="â—€" styleClass="chart-nav-btn" onAction="#previousPeriod"/>
                <Label text="ðŸ—“ï¸ PÃ©riode: 1-30 Mars 2023" styleClass="period-label"/>
                <Button text="â–¶" styleClass="chart-nav-btn" onAction="#nextPeriod"/>
            </HBox>
        </VBox>
    </GridPane>


</VBox>